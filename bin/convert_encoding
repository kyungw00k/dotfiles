#!/bin/sh
 
FROM=euckr
TO=utf8
 
[ -z "$1" ] && exit
 
for target in `find $1 -path '*/.svn' -prune -o -type f`
do
 
        if file $target | grep -q text; then
                iconv -f $FROM -t $TO $target >/dev/null 2>&1 && cp $target $target.$FROM
                if [ -f $target.$FROM ]; then
                        iconv -f $FROM -t $TO $target.$FROM > $target.$TO && echo "Converted $target"
                        rm -f $target.$FROM
                        mv -f $target.$TO $target
                fi
        fi
done
